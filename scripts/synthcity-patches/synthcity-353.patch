From 8ae9641b2cb67ab5f5087bc995550fba54071c06 Mon Sep 17 00:00:00 2001
From: Hochan Son <ohsono@gmail.com>
Date: Thu, 18 Dec 2025 00:20:36 -0800
Subject: [PATCH] =?UTF-8?q?feat:=20upgrade=20PyTorch=20support=20from=202.?=
 =?UTF-8?q?1-2.2=20to=202.3+=20with=20tsai=200.4.1-=20Upgrade=20PyTorch=20?=
 =?UTF-8?q?from=20<2.3=20to=20>=3D2.3=20(supports=202.7+=20and=202.8.0)-?=
 =?UTF-8?q?=20Update=20tsai=20to=20>=3D0.4.1=20for=20better=20PyTorch=20co?=
 =?UTF-8?q?mpatibility=20=20-=20Update=20opacus=20to=20>=3D1.5.4=20for=20R?=
 =?UTF-8?q?MSNorm=20support-=20Update=20fastai=20to=20>=3D2.8=20and=20fast?=
 =?UTF-8?q?core=20to=20>=3D1.8=20(required=20by=20tsai=200.4.1)-=20Remove?=
 =?UTF-8?q?=20version=20caps=20on=20transformers=20and=20accelerate-=20Pin?=
 =?UTF-8?q?=20xgbse=20to=20=3D=3D0.3.3=20for=20stabilityThis=20upgrade=20e?=
 =?UTF-8?q?nables=20the=20use=20of=20modern=20PyTorch=20versions=20while?=
 =?UTF-8?q?=20maintainingbackward=20compatibility.=20Successfully=20tested?=
 =?UTF-8?q?=20with=20PyTorch=202.7.1=20and=20verifiedworking=20with=20PyTo?=
 =?UTF-8?q?rch=202.8.0.Key=20changes:-=20torch:=20>=3D2.1,=20<2.3=20?=
 =?UTF-8?q?=E2=86=92=20>=3D2.3-=20tsai:=20(any)=20=E2=86=92=20>=3D0.4.1-?=
 =?UTF-8?q?=20opacus:=20>=3D1.3,=20<1.5.4=20=E2=86=92=20>=3D1.5.4-=20fasta?=
 =?UTF-8?q?i/fastcore:=20<2.8/<1.8=20=E2=86=92=20>=3D2.8/>=3D1.8-=20transf?=
 =?UTF-8?q?ormers/accelerate:=20removed=20version=20caps.Resolves=20compat?=
 =?UTF-8?q?ibility=20issues=20with=20newer=20PyTorch=20ecosystem=20while?=
 =?UTF-8?q?=20maintainingco\mpatibility=20with=20xgbse=20and=20lifelines?=
 =?UTF-8?q?=20constraints.?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 prereq.txt |  4 ++--
 setup.cfg  | 18 +++++++++---------
 2 files changed, 11 insertions(+), 11 deletions(-)

diff --git a/prereq.txt b/prereq.txt
index 75d0c81e..2d6fae3f 100644
--- a/prereq.txt
+++ b/prereq.txt
@@ -1,4 +1,4 @@
 numpy>=1.20
-torch>=2.1, <2.3 # Max due to tsai
-tsai
+torch>=2.1 # Min due to opacus, tsai 0.4.1+ supports latest PyTorch
+tsai>=0.4.1
 wheel>=0.40
diff --git a/setup.cfg b/setup.cfg
index e4623326..e69d8171 100644
--- a/setup.cfg
+++ b/setup.cfg
@@ -34,12 +34,12 @@ python_requires = >=3.9
 install_requires =
     importlib-metadata
     pandas>=2.1 # min due to lifelines
-    torch>=2.1, <2.3 # Max due to tsai, min due to opacus
+    torch>=2.3 # Min due to opacus, tsai 0.4.1+ supports latest PyTorch
     scikit-learn>=1.2
     nflows>=0.14
-    numpy>=1.20, <2.0
+    numpy>=1.20, <2.0 # max due to lifelines 0.29.0 requirement
     lifelines>=0.29.0, <0.30.0 # max due to xgbse
-    opacus>=1.3, <1.5.4 # 1.5.4 introduces RMSNorm error
+    opacus>=1.5.4 # RMSNorm support required for PyTorch 2.x compatibility
     networkx>2.0,<3.0
     decaf-synthetic-data>=0.1.7
     optuna>=3.1
@@ -55,17 +55,17 @@ install_requires =
     pgmpy<1.0
     redis
     pycox
-    xgbse>=0.3.1
+    xgbse==0.3.3
     pykeops
     fflows
     monai
-    tsai; python_version>"3.7"
+    tsai>=0.4.1; python_version>"3.7"
     be-great>=0.0.5;python_version>="3.9"
     arfpy
-    fastcore<1.8 # Required by breaking change in fastai 2.8 which is needed by tsai
-    fastai<2.8 # Required by breaking change in fastai 2.8 which is needed by tsai
-    transformers<4.33.0 # Required by great plugin while tranformers >4.33.0 is not compatible with torch <2.5
-    accelerate<0.20.4 # Required for transformers <4.33.0
+    fastcore>=1.8 # Required for tsai 0.4.1+ compatibility
+    fastai>=2.8 # Required for tsai 0.4.1+ compatibility
+    transformers # Now compatible with latest PyTorch
+    accelerate # Now compatible with latest PyTorch and transformers
 
 
 [options.packages.find]
